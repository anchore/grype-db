package model

import (
	"github.com/anchore/siren-db/pkg/db"
)

type VulnerabilityMetadataIndex struct {
	ID           string
	RecordSource string
}

type VulnerabilityMetadata struct {
	Index    VulnerabilityMetadataIndex `storm:"id"`
	Severity string
	Links    []string
}

func NewVulnerabilityMetadataModel(metadata db.VulnerabilityMetadata) VulnerabilityMetadata {
	return VulnerabilityMetadata{
		Index: VulnerabilityMetadataIndex{
			ID:           metadata.ID,
			RecordSource: metadata.RecordSource,
		},
		Severity:     metadata.Severity,
		Links:        metadata.Links,
	}
}

func (m *VulnerabilityMetadata) Inflate() db.VulnerabilityMetadata {
	return db.VulnerabilityMetadata{
		ID:           m.Index.ID,
		RecordSource: m.Index.RecordSource,
		Severity:     m.Severity,
		Links:        m.Links,
	}
}
